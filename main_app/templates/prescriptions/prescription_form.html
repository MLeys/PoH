{% extends 'base.html' %}

{% block content %}

  <link href='https://clinicaltables.nlm.nih.gov/autocomplete-lhc-versions/17.0.2/autocomplete-lhc.min.css' rel="stylesheet">
  <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js'></script>
  <script src='https://clinicaltables.nlm.nih.gov/autocomplete-lhc-versions/17.0.2/autocomplete-lhc.min.js'></script>
<div class="container-fluid my-2">
  <div class="row justify-content-center">
    <div class="col-sm col-md-8 align-self-center">
      <div class="card">
        <div class="card-body">
          <div class="card-title">
            
            {% if object %}
            <h1>Edit <span class="text-primary">{{object.name}}</span></h1>
            {% else %}
            <h1 class="card-text">Add Medication</h1>
            {% endif %}
          </div>
          <div class="card-text">
            <form action="" method="post">
              {% csrf_token %}
              
              {{ form.as_p }}
              <div class="d-grid gap-0 ">
                <input type="submit" value="Submit!" class="btn btn-success">
              </div>
            </form>
          </div>
        </div> <!-- End Card Body for form  -->
      </div> <!-- End Card -->
    </div> <!-- End Col-->
  </div><!-- End Row-->
  <div class="row my-3">
    <input type="text" id="prescriptionName" placeholder="Medication name">
    <input type="text" id="prescriptionStrength" placeholder="Strength list">
  </div>

</div>
<br><br>


<script>
  new Def.Autocompleter.Prefetch('prescriptionStrength', []);
  new Def.Autocompleter.Search('prescriptionName',
    'https://clinicaltables.nlm.nih.gov/api/rxterms/v3/search?ef=STRENGTHS_AND_FORMS');
  Def.Autocompleter.Event.observeListSelections('prescriptionName', function() {
    const drugField = $('#prescriptionName')[0];
    const autocomp = drugField.autocomp;
    const strengths =
      autocomp.getSelectedItemData()[0].data['STRENGTHS_AND_FORMS'];
    if (strengths)
      $('#prescriptionStrength')[0].autocomp.setListAndField(strengths, '');
})
</script>
{% endblock content %}